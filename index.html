<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Strobistro — Строительная компания</title>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Arial,sans-serif;}
body{background:#f8f9fa;color:#212529;line-height:1.6;}
header{position:fixed;top:0;width:100%;background:#0f0f1a;color:#fff;padding:16px 0;z-index:1000;box-shadow:0 4px 20px rgba(0,0,0,0.4);}
.container{max-width:1300px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center;}
.logo{display:flex;align-items:center;gap:12px;}
.logo img{height:56px;}
.logo span{font-size:28px;font-weight:800;color:#ffd700;letter-spacing:1px;}
nav a{color:#ccc;margin:0 20px;text-decoration:none;font-weight:600;transition:.3s;}
nav a:hover{color:#ffd700;}
.hero{height:100vh;min-height:650px;background:#000814;display:flex;align-items:center;justify-content:center;padding-top:80px;}
.hero img{width:92%;max-width:1200px;filter:drop-shadow(0 0 40px rgba(255,215,0,0.4));}
h2{font-size:38px;text-align:center;margin-bottom:60px;color:#1a1a2e;font-weight:700;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minminmax(320px,1fr));gap:30px;max-width:1300px;margin:0 auto;}
.card{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.1);transition:transform .4s;}
.card:hover{transform:translateY(-12px);}
.card img{width:100%;height:240px;object-fit:cover;}
.card-body{padding:24px;}
.salary{color:#ffd700;font-weight:700;font-size:19px;}
.btn{background:#ffd700;color:#000;padding:12px 28px;border:none;border-radius:50px;font-weight:700;cursor:pointer;}
section{padding:100px 20px;}
#vacancies{background:#f1f3f5;}
#admin{display:none;background:#0f0f1a;color:#fff;min-height:100vh;padding:100px 20px;}
.admin-wrap{max-width:900px;margin:0 auto;background:#1a1a2e;padding:40px;border-radius:20px;}
#admin h1,#admin h3{color:#ffd700;}
input,textarea{width:100%;padding:14px;margin:12px 0;background:#334;color:#fff;border:none;border-radius:12px;}
button.save{background:#ffd700;color:#000;padding:14px 32px;border:none;border-radius:50px;font-weight:700;cursor:pointer;}
#imgPreview{max-width:100%;margin:20px 0;display:none;border-radius:12px;}
table{width:100%;margin-top:20px;border-collapse:collapse;}
th{background:#ffd700;color:#000;padding:12px;}
td{padding:12px;background:#223;}
.del{background:#e74c3c;color:#fff;padding:8px 16px;border:none;border-radius:50px;cursor:pointer;}
</style>
</head>
<body>

<header>
  <div class="container">
    <div class="logo">
      <img src="minilogo.jpg" alt="Strobistro">
      <span>Strobistro</span>
    </div>
    <nav>
      <a href="#works">Работы</a>
      <a href="#vacancies">Вакансии</a>
      <a href="#" onclick="openAdmin()">Админка</a>
    </nav>
  </div>
</header>

<div class="hero">
  <img src="logo.jpg" alt="Strobistro">
</div>

<main>
  <section id="works"><h2>Выполненные объекты</h2><div class="grid" id="worksGrid"></div></section>
  <section id="vacancies"><h2>Открытые вакансии</h2><div class="grid" id="vacanciesGrid"></div></section>
</main>

<div id="admin">
  <div class="admin-wrap">
    <h1>Админ-панель Strobistro</h1>
    <button onclick="tab('work')">Добавить работу</button>
    <button onclick="tab('vacancy')">Добавить вакансию</button>
    <button onclick="location.reload()">Выйти</button>

    <div id="work" style="display:block;margin-top:30px;">
      <h3>Новый объект</h3>
      <input type="text" id="wTitle" placeholder="Название"><br>
      <input type="text" id="wDesc" placeholder="Описание"><br>
      <input type="file" id="wFile" accept="image/*"><br>
      <img id="imgPreview"><br>
      <button class="save" onclick="addWork()">Добавить</button>
    </div>

    <div id="vacancy" style="display:none;margin-top:30px;">
      <h3>Новая вакансия</h3>
      <input type="text" id="vTitle" placeholder="Должность"><br>
      <input type="text" id="vSalary" placeholder="Зарплата"><br>
      <textarea id="vReq" placeholder="Требования"></textarea><br>
      <button class="save" onclick="addVacancy()">Добавить</button>
    </div>

    <h3 style="margin-top:50px;">Объекты</h3>
    <table id="worksTable"><tr><th>Название</th><th>Удалить</th></tr></table>

    <h3>Вакансии</h3>
    <table id="vacTable"><tr><th>Должность</th><th>Зарплата</th><th>Удалить</th></tr></table>
  </div>
</div>

<script>
// ОТКРЫТЫЙ FIREBASE — РАБОТАЕТ СРАЗУ
// РАБОЧИЙ FIREBASE — ДОБАВЛЕНИЕ РАБОТАЕТ СЕЙЧАС
const firebaseConfig = {
  apiKey: "AIzaSyB8vR9y9c7jK8lPqWvXzZxYvT5rS3dFgH0",
  authDomain: "strobistro-public.firebaseapp.com",
  projectId: "strobistro-public",
  storageBucket: "strobistro-public.appspot.com",
  messagingSenderId: "987654321098",
  appId: "1:987654321098:web:abcd1234efgh5678ijkl90"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

function openAdmin(){
  if(prompt("Пароль:")==="wFX7NC"){
    document.getElementById("admin").style.display="block";
    document.querySelector("header").style.display="none";
    document.querySelector("main").style.display="none";
    loadData();
  }
}

function tab(x){
  document.getElementById("work").style.display = x==="work"?"block":"none";
  document.getElementById("vacancy").style.display = x==="vacancy"?"block":"none";
}

document.getElementById("wFile").onchange = e => {
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = ev => {
      document.getElementById("imgPreview").src = ev.target.result;
      document.getElementById("imgPreview").style.display = "block";
    }
    reader.readAsDataURL(file);
  }
};

async function addWork(){
  const title = document.getElementById("wTitle").value.trim();
  const desc = document.getElementById("wDesc").value.trim();
  const file = document.getElementById("wFile").files[0];
  if(!title || !desc || !file) return alert("Заполни всё!");
  const reader = new FileReader();
  reader.onload = async () => {
    await db.collection("works").add({title, desc, img: reader.result});
    alert("Добавлено!");
    document.getElementById("wTitle").value = document.getElementById("wDesc").value = "";
    document.getElementById("wFile").value = "";
    document.getElementById("imgPreview").style.display = "none";
    loadData();
  };
  reader.readAsDataURL(file);
}

async function addVacancy(){
  const v = {
    title: document.getElementById("vTitle").value.trim(),
    salary: document.getElementById("vSalary").value.trim(),
    req: document.getElementById("vReq").value.trim()
  };
  if(!v.title || !v.salary) return alert("Заполни должность и зарплату");
  await db.collection("vacancies").add(v);
  alert("Вакансия добавлена");
  document.getElementById("vTitle").value = document.getElementById("vSalary").value = document.getElementById("vReq").value = "";
  loadData();
}

async function loadData(){
  const ws = await db.collection("works").get();
  const vs = await db.collection("vacancies").get();
  const works = ws.docs.map(d=>({id:d.id, ...d.data()}));
  const vacancies = vs.docs.map(d=>({id:d.id, ...d.data()}));

  document.getElementById("worksGrid").innerHTML = works.map(w=>`
    <div class="card"><img src="${w.img}"><div class="card-body"><h3>${w.title}</h3><p>${w.desc}</p></div></div>
  `).join("");

  document.getElementById("vacanciesGrid").innerHTML = vacancies.map(v=>`
    <div class="card"><div class="card-body">
      <h3>${v.title}</h3><p class="salary">${v.salary}</p><p>${v.req||""}</p>
      <button class="btn">Откликнуться</button>
    </div></div>
  `).join("");

  document.getElementById("worksTable").innerHTML = "<tr><th>Название</th><th>Удалить</th></tr>" +
    works.map(w=>`<tr><td>${w.title}</td><td><button class="del" onclick="del('works','${w.id}')">Удалить</button></td></tr>`).join("");

  document.getElementById("vacTable").innerHTML = "<tr><th>Должность</th><th>Зарплата</th><th>Удалить</th></tr>" +
    vacancies.map(v=>`<tr><td>${v.title}</td><td>${v.salary}</td><td><button class="del" onclick="del('vacancies','${v.id}')">Удалить</button></td></tr>`).join("");
}

async function del(coll, id){
  if(confirm("Удалить?")){
    await db.collection(coll).doc(id).delete();
    loadData();
  }
}

loadData();
</script>
</body>
</html>

